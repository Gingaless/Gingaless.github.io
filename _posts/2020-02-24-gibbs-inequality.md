---

title: "깁스 부등식(Gibbs' Inequality)"
date: 2020-02-24 14:08:00 +0000
categories: [ML]
comments: true
published: true

---

이전 크로스 엔트로피 글에서 깁스 부등식에 의해 KLD가 0보다 크거나 같다는 말을 했었다.

그럼 깁스 부등식은 무엇일까?

깁스 부등식의 내용은 다음과 같다.

$$
-\sum _{x \in \chi} p(x) \log p(x) \leq -\sum _{x \in \chi} p(x) \log q(x),\, p, q \text{는 확률분포함수, } \chi = supp(p), \, supp(f) \text{는 함수 f의 값이 0이 아닌 정의역의 부분집합}
\\
\text{또한, 등호는 오직 모든 $x \in \chi$에 대하여 } p(x) = q(x) \text{일 때에만 성립한다.}
$$

깁스 부등식에서 좌변을 우변으로 넘기면 'KLD는 항상 0보다 크거나 같으며 등호는 두 확률분포가 같을 때에만 성립한다.'가 된다.

깁스 부등식이 뭔지 알았으니 이제 증명을 해보자.

증명은 킹갓엠페러위키피디아를 참조하였습니다^^

좀 복잡한 부등식의 증명은 우리가 대소관계를 확실히 알 수 있는 식을 부등식의 중간에 낑겨넣어서 하는 경우가 많..나?

여튼 깁스 부등식도 그런 식으로 증명한다.

그전에 먼저, $$\chi _p = supp(p)$$, $$\chi _q = supp(q)$$라고 표기하기로 하고, p(x), q(x)는 그냥 p, q라고 나타내기로 하자.

깁스 부등식을 풀기 위해서, 깁스부등식을 구성하는 일차함수나 로그함수보다 항상 더 크거나 같은 값을 갖는(혹은 더 작거나 같은 값을 갖는) 함수를 찾아보기로 하자.

로그함수보다 항상 더 작은 값을 갖는 함수를 찾긴 어렵지만, 항상 크거나 같은 값을 갖는 함수는 찾기 쉽다.

![gibbs0](https://user-images.githubusercontent.com/35564159/74998181-60dd4780-549b-11ea-94f7-33b1384a9ec2.png)

$$f(x) = x - 1$$이 바로 그것이다.

위의 그림대로, f는 항상 log함수와 접하거나 그 위에 있다.

근데 시발 github blog에 함수 그래프 대체 어케 넣는거지

자, 어쨌든간에 깁스 부등식의 중간에 낑겨들어가서 증명을 도와줄만한 절대부등식을 찾았으니 바로 깁스부등식에 적용해보자.

깁스부등식의 우변을 전부 좌변으로 모으면 이렇게 된다.

$$- \sum _{x \in \chi} p \log \frac{q}{p} \geq 0$$

우리가 찾은 절대부등식에 의해,

$$\sum _{x \in \chi} p \log \frac{q}{p} \leq \sum _{x \in \chi} p ( \frac{q}{p} - 1 ) = \sum _{x \in \chi} (q - p)$$

여기에 $$-$$를 붙이면,

$$- \sum _{x \in \chi} p \log \frac{q}{p} \geq \sum _{x \in \chi} p - \sum _{x \in \chi} q = 1  - \sum _{x \in \chi} q \geq 0$$

가 되므로, 깁스부등식이 증명된다.

잉? 만약 $$supp(p)$$ 영역에 $$q = 0$$인 지점이 있으면 어떻게 하냐고?

그럴 때도 깁스부등식은 성립한다. 깁스부등식의 우변이 $$+ \infty$$가 되기 때문에 무조건 좌변보다 크기 때문이다.

자, 이제 등호가 성립할 때를 증명해보자.

$$supp(p)$$에서 $$p = q$$일 때 깁스부등식에서 등호가 성립한다는 것은 자명한 사실이다.

그러면 KLD가 0일 때 반드시 $$p = q$$인가?

총합이 들어있는 깁스 부등식 자체로 이것을 직접 보이기는 어려워보인다.

이럴땐 대개 대우(contraposition)을 취하거나 귀류법(reductio ad absurdum)을 이용하면 돌파구가 나온다.

귀류법을 써서, 조건 하에서 $$\exists x \in \chi \text{ such that }p \neq q$$라고 가정하자.

그리고 그 가정의 대우를 취하면,

'모든 x에 대하여 p=q이면 KLD는 0이 아니다.'가 되는데, 명백한 거짓이다.

따라서 가정은 모순이 되고, 본래의 명제가 참인 것이 증명된다.

자, 이제 등호가 오직 $$p = q$$일 때만 성립한다는 것도 보였다.

이것으로 이 글을 마치도록 하겠다.

머-바-!(머신러닝 바이라는 뜻 ㅎ)

